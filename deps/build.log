project(Lints)

cmake_minimum_required(VERSION 2.8.12)
#set(CMAKE_INSTALL_RPATH "${CMAKE_BINARY_DIR}/lib")
set(CMAKE_MACOSX_RPATH 1)
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/lib")
set(CMAKE_CXX_FLAGS "-I/usr/include/eigen3 -I${CMAKE_BINARY_DIR}/include/ -L/home/mmd01986/.julia/artifacts/102529506b62a991eeacee8e81c5eb01a560459e/lib/liblibint2.so")
#set(CMAKE_CXX_FLAGS "-I/usr/include/eigen3 -L${CMAKE_BINARY_DIR}/lib/")


find_package(JlCxx REQUIRED)
#find_package(Libint2 REQUIRED)
find_package(Eigen3 REQUIRED)
get_target_property(JlCxx_location JlCxx::cxxwrap_julia LOCATION)
get_filename_component(JlCxx_location ${JlCxx_location} DIRECTORY)
set(CMAKE_SKIP_BUILD_RPATH TRUE)
set(CMAKE_BUILD_WITH_INSTALL_RPATH TRUE)
set(CMAKE_INSTALL_RPATH "\$ORIGIN:${CMAKE_INSTALL_PREFIX}/lib:${JlCxx_location}")
set(CMAKE_INSTALL_RPATH_USE_LINK_PATH TRUE)

message(STATUS "Found JlCxx at ${JlCxx_location}")

add_library(Lints SHARED ../src/Lints.cpp)

link_directories(${CMAKE_BINARY_DIR}/lib/)
target_link_libraries(Lints JlCxx::cxxwrap_julia)
target_link_libraries(Lints libint2)

install(TARGETS
    Lints
LIBRARY DESTINATION lib
ARCHIVE DESTINATION lib
RUNTIME DESTINATION lib)
-- The C compiler identification is GNU 7.5.0
-- The CXX compiler identification is GNU 7.5.0
-- Check for working C compiler: /usr/bin/cc
-- Check for working C compiler: /usr/bin/cc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Detecting C compile features
-- Detecting C compile features - done
-- Check for working CXX compiler: /usr/bin/c++
-- Check for working CXX compiler: /usr/bin/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Found Julia executable: /home/mmd01986/julia-1.4.1/bin/julia
-- Julia_VERSION_STRING: 1.4.1
-- Julia_INCLUDE_DIRS:   /home/mmd01986/julia-1.4.1/include/julia
-- Julia_LIBRARY_DIR:    /home/mmd01986/julia-1.4.1/lib
-- Julia_LIBRARY:        /home/mmd01986/julia-1.4.1/lib/libjulia.so.1
-- JULIA_HOME:           /home/mmd01986/julia-1.4.1/bin
-- Julia_LLVM_VERSION:   v8.0.1
-- Julia_WORD_SIZE:      64
-- Found Julia: /home/mmd01986/julia-1.4.1/lib/libjulia.so.1 (found version "1.4.1") 
-- Found JlCxx at /home/mmd01986/.julia/artifacts/d54a2909808f0f05123ef98f8eef4fcde1073e52/lib
-- Configuring done
-- Generating done
-- Build files have been written to: /home/mmd01986/.julia/dev/Lints/deps
Scanning dependencies of target Lints
[ 50%] Building CXX object CMakeFiles/Lints.dir/home/mmd01986/.julia/dev/Lints/src/Lints.cpp.o
[100%] Linking CXX shared library lib/libLints.so
[100%] Built target Lints
